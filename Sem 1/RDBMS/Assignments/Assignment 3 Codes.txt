## ASSIGNMENT 3 ##


CREATE TABLE CLIENT_MASTER2(CLIENT_NO VARCHAR2(6) PRIMARY KEY CHECK(CLIENT_NO LIKE 'C%'), NAME VARCHAR2(20) NOT NULL, ADDRESS1 VARCHAR2(30), ADDRESS2 VARCHAR2(30), CITY VARCHAR2(15), PINCODE NUMBER(8), STATE VARCHAR2(15), BAL_DUE NUMBER(10,2));

DESC CLIENT_MASTER2;

CREATE TABLE PRODUCT_MASTER2(PRODUCT_NO VARCHAR2(6) PRIMARY KEY CHECK(PRODUCT_NO LIKE 'P%'), DESCRIPTION VARCHAR2(15) NOT NULL, PROFIT_PERCENT NUMBER(4,2) NOT NULL, UNIT_MEASURE VARCHAR2(10) NOT NULL, QTY_ON_HAND NUMBER(8) NOT NULL, REORDER_LVL NUMBER(8) NOT NULL, SELL_PRICE NUMBER(8,2) NOT NULL CHECK(SELL_PRICE <> 0), COST_PRICE NUMBER(8,2) NOT NULL CHECK(COST_PRICE <> 0));

DESC PRODUCT_MASTER2;


CREATE TABLE SALESMAN_MASTER2(SALESMAN_NO VARCHAR2(6) PRIMARY KEY CHECK(SALESMAN_NO LIKE 'S%'), SALESMAN_NAME VARCHAR2(20) NOT NULL, ADDRESS1 VARCHAR2(30) NOT NULL, ADDRESS2 VARCHAR2(30), CITY VARCHAR2(20), PINCODE NUMBER(8), STATE VARCHAR2(20), SAL_AMT NUMBER(8,2) NOT NULL CHECK(SAL_AMT <> 0), TGT_TO_GET NUMBER(6,2) NOT NULL CHECK(TGT_TO_GET <> 0), YTD_SALES NUMBER(6,2) NOT NULL, REMARKS VARCHAR2(60));

DESC SALESMAN_MASTER2;

CREATE TABLE SALES_ORDER2(ORDER_NO VARCHAR2(6) PRIMARY KEY CHECK(ORDER_NO LIKE 'O%'), CLIENT_NO VARCHAR2(6), FOREIGN KEY(CLIENT_NO) REFERENCES CLIENT_MASTER2, ORDER_DATE DATE NOT NULL, DELYA_ADDR VARCHAR2(25), SALESMAN_NO VARCHAR2(6), FOREIGN KEY(SALESMAN_NO) REFERENCES SALESMAN_MASTER2, DELY_TYPE CHAR(1) DEFAULT 'F' CHECK(DELY_TYPE IN('P','F')), BILL_YN CHAR(1), DELY_DATE DATE, ORDER_STATUS VARCHAR2(10) CHECK(ORDER_STATUS IN('In Process', 'Fulfilled', 'BackOrder', 'Cancelled')), CONSTRAINT CHK_DELY_DATE CHECK (DELY_DATE >= ORDER_DATE));

ALTER TABLE SALES_ORDER2 DROP CONSTRAINT CHK_DELY_DATE;
ALTER TABLE SALES_ORDER2 ADD CONSTRAINT CHK_DELY_DATE CHECK(DELY_DATE >= ORDER_DATE);
DESC SALES_ORDER2;

CREATE TABLE SALES_ORDER_DETAILS(ORDER_NO VARCHAR2(6), FOREIGN KEY(ORDER_NO) REFERENCES SALES_ORDER2, PRODUCT_NO VARCHAR2(6), FOREIGN KEY(PRODUCT_NO) REFERENCES PRODUCT_MASTER2, QTY_ORDERED NUMBER(8), QTY_DISP NUMBER(8), PRODUCT_RATE NUMBER(10,2));

DESC SALES_ORDER_DETAILS;

INSERT INTO CLIENT_MASTER2(CLIENT_NO, NAME, ADDRESS1, ADDRESS2, CITY, PINCODE, STATE, BAL_DUE) VALUES (:CLIENT_NO, :NAME, :ADDRESS1, :ADDRESS2, :CITY, :PINCODE, :STATE, :BAL_DUE);

DELETE FROM CLIENT_MASTER2;

INSERT INTO CLIENT_MASTER2 SELECT * FROM CLIENT_MASTER;

SELECT * FROM CLIENT_MASTER2;

UPDATE CLIENT_MASTER2 SET CITY='Mumbai' WHERE NAME='Hansel Colaco';
UPDATE CLIENT_MASTER2 SET BAL_DUE=15000 WHERE NAME='Ivan Bayross';

INSERT INTO PRODUCT_MASTER2 SELECT * FROM PRODUCT_MASTER;

SELECT * FROM PRODUCT_MASTER2;

UPDATE PRODUCT_MASTER2 SET COST_PRICE=550 WHERE DESCRIPTION='Trousers';

INSERT INTO SALESMAN_MASTER2 SELECT * FROM SALESMAN_MASTER;

SELECT * FROM SALESMAN_MASTER2;

UPDATE SALESMAN_MASTER2 SET CITY='Mumbai';

INSERT INTO SALES_ORDER2(ORDER_NO, CLIENT_NO, ORDER_DATE, SALESMAN_NO, DELY_TYPE, BILL_YN, DELY_DATE, ORDER_STATUS) VALUES (:ORDER_NO, :CLIENT_NO, TO_DATE(:ORDER_DATE, 'DD-MM-YYYY'), :SALESMAN_NO, :DELY_TYPE, :BILL_YN, TO_DATE(:DELY_DATE, 'DD-MM-YYYY'), :ORDER_STATUS);

SELECT * FROM SALES_ORDER2;
ALTER TABLE SALES_ORDER2 RENAME COLUMN DELYA_ADDR TO DELY_ADDR;
DELETE FROM SALES_ORDER2;

UPDATE SALES_ORDER2 SET ORDER_NO='O46865' WHERE CLIENT_NO='C00003';

INSERT INTO SALES_ORDER_DETAILS(ORDER_NO, PRODUCT_NO, QTY_ORDERED, QTY_DISP, PRODUCT_RATE) VALUES (:ORDER_NO, :PRODUCT_NO, :QTY_ORDERED, :QTY_DISP, :PRODUCT_RATE);

SELECT * FROM SALES_ORDER_DETAILS;

UPDATE SALES_ORDER_DETAILS SET ORDER_NO='O19001' WHERE QTY_ORDERED=4;